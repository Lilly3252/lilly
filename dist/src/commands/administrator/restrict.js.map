{"version":3,"file":"restrict.js","sourceRoot":"./src/","sources":["src/commands/administrator/restrict.ts"],"names":[],"mappings":"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","sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\r\n/* eslint-disable @typescript-eslint/no-non-null-assertion */\r\n/* eslint-disable @typescript-eslint/no-unused-vars */\r\nimport type { ChatInputCommandInteraction } from \"discord.js\";\r\nimport type { SlashCommand } from \"../../structures/index.js\";\r\nimport { PermissionsBitField, SlashCommandBuilder } from \"discord.js\";\r\nimport SYSTEM from \"../../structures/messageSystem.json\";\r\nimport * as Embed from \"../../structures/messageEmbeds.js\";\r\nimport { prisma } from \"../../index.js\";\r\nexport const slashy: SlashCommand[\"slashy\"] = new SlashCommandBuilder()\r\n    .setName(\"restrict\")\r\n    .setDescription(\"restrict a member.\")\r\n    .addUserOption((option) =>\r\n        option\r\n            .setName(\"member\")\r\n            .setDescription(\"Mention someone to restrict\")\r\n            .setRequired(true)\r\n    )\r\n    .addStringOption((option) =>\r\n        option\r\n            .setName(\"restrictions\")\r\n            .setDescription(\"Choose a restriction\")\r\n            .setRequired(true)\r\n            .addChoices({ name: \"Embed\", value: \"embed\" }, { name: \"Reaction\", value: \"reaction\" }, { name: \"Voice\", value: \"voice\" }, { name: \"Slash\", value: \"slash\" })\r\n            .setRequired(true)\r\n    )\r\n    .addStringOption((option) =>\r\n        option\r\n            .setName(\"reasons\")\r\n            .setDescription(\"Specify a reason\")\r\n            .setRequired(true)\r\n    )\r\n    .setDefaultMemberPermissions(PermissionsBitField.Flags.ManageRoles)\r\n\r\n\r\nexport const run: SlashCommand[\"run\"] = async (interaction: ChatInputCommandInteraction<\"cached\">): Promise<void> => {\r\n    if (!interaction.guild.members.me?.permissions.has(PermissionsBitField.Flags.ManageRoles)) {\r\n        return void interaction.reply({\r\n            content: SYSTEM.ERROR.PERMISSIONS.BOT_PERM[\"MANAGE_ROLES\"],\r\n            ephemeral: true,\r\n        });\r\n    }\r\n    const database = await prisma.guild.findFirst({ where: { guildID: interaction.guild.id } });\r\n    const member = interaction.options.getMember(\"member\")!;\r\n    const reason = interaction.options.getString(\"reasons\")!;\r\n    const restriction_name = interaction.options.getString(\"restrictions\")!;\r\n    const data = database?.logChannelID;\r\n\r\n    if (!member.moderatable || !member.manageable) {\r\n        await interaction.reply({\r\n            content: SYSTEM.ERROR.ADMIN.MODERATION_DENIED,\r\n            ephemeral: true,\r\n        });\r\n    }\r\n    switch (restriction_name) {\r\n        case \"embed\": {\r\n            let Embedrole = interaction.guild.roles.cache.find((role) => role.name === \"Embed Restriction\");\r\n            if (!Embedrole)\r\n                try {\r\n                    (Embedrole = await interaction.guild.roles.create({\r\n                        name: \"Embed Restriction\",\r\n                        color: \"#514f48\",\r\n                    })),\r\n                        Embedrole.permissions.remove(\"EmbedLinks\", \"AttachFiles\");\r\n                } catch (a: any) {\r\n                    console.log(a.stack);\r\n                }\r\n            member.roles.add(Embedrole!).then(() => {\r\n                member\r\n                    .send(\r\n                        `Hello, you have been restricted in ${interaction.guild.name} for: ${reason}`\r\n                    )\r\n                    .catch((a) => console.log(a)),\r\n                    interaction.reply({\r\n                        content: `${member.user.username} was successfully restricted.`,\r\n                        ephemeral: true,\r\n                    });\r\n            });\r\n            break;\r\n        }\r\n        case \"reaction\": {\r\n            let Reactionrole = interaction.guild.roles.cache.find((role) => role.name === \"Reaction Restriction\");\r\n            if (!Reactionrole)\r\n                try {\r\n                    (Reactionrole = await interaction.guild.roles.create({\r\n                        name: \"Reaction Restriction\",\r\n                        color: \"#514f48\",\r\n                    })),\r\n                        Reactionrole.permissions.remove(\"AddReactions\");\r\n                } catch (a: any) {\r\n                    console.log(a.stack);\r\n                }\r\n            member.roles.add(Reactionrole!).then(() => {\r\n                member\r\n                    .send(\r\n                        `Hello, you have been restricted in ${interaction.guild.name} for: ${reason}`\r\n                    )\r\n                    .catch((a) => console.log(a)),\r\n                    interaction.reply({\r\n                        content: `${member.user.username} was successfully restricted.`,\r\n                        ephemeral: true,\r\n                    });\r\n            });\r\n            break;\r\n        }\r\n        case \"slash\": {\r\n            let Slashrole = interaction.guild.roles.cache.find((role) => role.name === \"Slash Restriction\");\r\n            if (!Slashrole)\r\n                try {\r\n                    (Slashrole = await interaction.guild.roles.create({\r\n                        name: \"Slash Restriction\",\r\n                        color: \"#514f48\",\r\n                    })),\r\n                        Slashrole.permissions.remove(\"UseApplicationCommands\")\r\n                } catch (a: any) {\r\n                    console.log(a.stack);\r\n                }\r\n            member.roles.add(Slashrole!).then(() => {\r\n                member\r\n                    .send(\r\n                        `Hello, you have been restricted in ${interaction.guild.name} for: ${reason}`\r\n                    )\r\n                    .catch((a) => console.log(a)),\r\n                    interaction.reply({\r\n                        content: `${member.user.username} was successfully restricted.`,\r\n                        ephemeral: true,\r\n                    });\r\n            });\r\n            break;\r\n        }\r\n        case \"voice\": {\r\n            let Voicerole = interaction.guild.roles.cache.find((role) => role.name === \"Voice Restriction\");\r\n            if (!Voicerole)\r\n                try {\r\n                    (Voicerole = await interaction.guild.roles.create({\r\n                        name: \"Voice Restriction\",\r\n                        color: \"#514f48\",\r\n                    })),\r\n                        Voicerole.permissions.remove(\"Stream\", \"Connect\", \"Speak\", \"UseVAD\")\r\n                } catch (a: any) {\r\n                    console.log(a.stack);\r\n                }\r\n            member.roles.add(Voicerole!).then(() => {\r\n                member\r\n                    .send(\r\n                        `Hello, you have been restricted in ${interaction.guild.name} for: ${reason}`\r\n                    )\r\n                    .catch((a) => console.log(a)),\r\n                    interaction.reply({\r\n                        content: `${member.user.username} was successfully restricted.`,\r\n                        ephemeral: true,\r\n                    });\r\n            });\r\n            member.voice.setChannel(null);\r\n        } break;\r\n\r\n    }\r\n\r\n    if (!data || data === null) { return }\r\n    const LogChannel = interaction.client.channels.cache.get(data);\r\n    if (!LogChannel || LogChannel === null) { return }\r\n    if (LogChannel?.isTextBased()) {\r\n        LogChannel?.send({\r\n            embeds: [Embed.RestrictEmbed(interaction, reason, restriction_name, member)],\r\n        });\r\n    }\r\n}"]}